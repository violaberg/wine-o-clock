{% extends "base.html" %}
{% load static %}
{% block content %}
<div class="container">
    <div class="row">
        <div class="col-md-12 text-center position-relative">
            <img src="{% static 'images/book-a-cellar-tour.jpeg' %}" class="img-fluid" alt="Wine pouring in glass sitting on wooden table in sunshine">
        </div>
    </div>
</div>
<div class="container">
    <header class="text-center mt-5">
        <h1 class="font-parisienne custom-white custom-header">Book a Tour</h1>
    </header>
    <div class="row mt-2">
        <div class="col-md-12 text-center">
            <p class="p-montserrat">
                Embark on a journey through the heart of our wine sanctuary with our exclusive cellar tour experience, immerse yourself in the rich history of our vineyards, witness the meticulous craftsmanship behind each bottle, and indulge in the captivating stories that make each sip extraordinary. Our knowledgeable guides will lead you through the hidden gems of our cellar, unveiling the artistry and passion that goes into crafting our exceptional wines. Whether you're a wine enthusiast or a casual connoisseur, a wine cellar tour with us promises an unforgettable blend of education, taste, and ambiance. Book your tour now and elevate your wine experience to new heights!
            </p>
        </div>
    </div>
    <!--Book a Tour form-->
    <form method="post" action="{% url 'book_a_tour' %}" class="text-center">
        {% csrf_token %}
        <!--Date & Time-->
        <div class="form-group" style="padding: 0.5rem;">
            <label class="label-fixed-width" for="{{ form.tour_date.id_for_label }}">Date & Time:</label>
            {{ form.tour_date }}
            {{ form.tour_date.errors }}
        </div>

        <!--Number of Guests-->
        <div class="form-group" style="padding: 0.5rem;">
            <label class="label-fixed-width" for="{{ form.num_guests.id_for_label }}">Nr of Guests:</label>
            {{ form.num_guests }}
            {{ form.num_guests.errors }}
        </div>

        <!--Name-->
        <div class="form-group" style="padding: 0.5rem;">
            <label class="label-fixed-width" for="{{ form.name.id_for_label }}">Name:</label>
            {{ form.name }}
            {{ form.name.errors }}
        </div>

        <!--Email-->
        <div class="form-group" style="padding: 0.5rem;">
            <label class="label-fixed-width" for="{{ form.email.id_for_label }}">Email:</label>
            {{ form.email }}
            {{ form.email.errors }}
        </div>

        <!--Phone Number-->
        <div class="form-group" style="padding: 0.5rem;">
            <label class="label-fixed-width" for="{{ form.phone.id_for_label }}">Phone:</label>
            {{ form.phone }}
            {{ form.phone.errors }}
        </div>

        <!--Book a Tour button-->
        <button type="submit" class="button book-a-tour-btn btn custom-white">Book a Tour</button>
    </form>
</div>
</div>
</div>
<!--Reviews-->
<div class="row text-center mt-5">
    <div class="col-md-12 text-center">
        <h1 class="font-parisienne custom-white text-center mt-4">Customer Reviews</h1>
        <!--Display Existing Reviews-->
        {% for review in reviews %}
            <div class="review">
                <p class="p-montserrat">{{ review.author }}</p>
                {% if review.image %}
                    <img src="{{ review.image.url }}" alt="Review Image">
                {% endif %}
                <span class="font-weight-normal">
                    {{ review.timestamp }}
                  </span>
                  <div id="review{{ review.id }}">
                    {{ review.text }}
                  </div>
                  {% if user.is_authenticated and review.author == user %}
                  <button class="button custom-white" data-review_id="{{ review.id }}">Delete</button>
                  <button class="button custom-white" data-review_id="{{ review.id }}">Edit</button>
                  {% endif %}
            </div>
        {% endfor %}
        <!--Form for new reviews-->
        <h2 class="p-montserrat">Leave a review</h2>
        <p class="p-montserrat">Writing as: <span class="font-parisienne custom-gold">{{ user.username }}</span></p>
        <div class="col-md-4 card">
            <div class="card-body">
                {% if user.is_authenticated %}
                <form action="{% url 'book_a_tour' %}" method="post">
                    {{ review_form }}
                    {% csrf_token %}
                    <button type="submit" class="button btn custom-white">Submit Review</button>
                </form>
                {% else %}
                <p class="p-montserrat">Log in to leave a review</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<!-- Delete confirmation modal -->
<div class="modal fade" id="deleteModal" tabindex="-1"
  aria-labelledby="deleteModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title"
          id="deleteModalLabel">Delete review?</h5>
        <button type="button" class="button custom-white btn-close"
          data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        Are you sure you want to delete your review?
        This action cannot be undone.
      </div>
      <div class="modal-footer">
        <button type="button" class="button custom-white"
          data-bs-dismiss="modal">Close</button>
        <a id="deleteConfirm" href="#" class="button
          custom-white">Delete</a>
      </div>
    </div>
  </div>
</div>
{% endblock content %}